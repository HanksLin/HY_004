<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>掃描結果</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin-top: 100px;
    }
    h1 {
      font-size: 32px;
    }
    p {
      font-size: 24px;
    }
  </style>
</head>
<body>
  <h1>林詩翰</h1>
  <p><span id="datetime"></span></p>

  <script>
    const now = new Date();
    const formatter = new Intl.DateTimeFormat('zh-TW', {
      year: 'numeric', month: '2-digit', day: '2-digit',
      hour: '2-digit', minute: '2-digit', second: '2-digit'
    });
    const datetime = formatter.format(now);
    document.getElementById("datetime").innerText = datetime;

    const name = "林詩翰"; // 可動態改變的姓名

    // 當頁面載入時自動提交資料到 Google 表單
    fetch('https://script.google.com/macros/s/AKfycbzSYPifeBOFGEKslByRzXJtgp8n-r1uV1P1rTFQTsN90fy6Rc-IEjA1P-pFWo-LXHW3/exec', {
      method: 'POST',
      body: new URLSearchParams({
        'name': name,
        'datetime': datetime
      })
    })
    .then(response => {
      if (response.ok) {
        console.log("打卡成功！");
      } else {
        console.log("打卡失敗！");
      }
    })
    .catch(error => console.error("錯誤:", error));
  </script>
</body>
</html>
